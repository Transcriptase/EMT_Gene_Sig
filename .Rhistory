library("lumi")
library("lumiMouseIDMapping")
library("lumiMouseAll.db")
library("annotate")
library("mogene10stprobeset.db")
library("limma")
#find files
CTR_PATH <- paste(getwd(),
"/Raw Lung Data/Ptran_not Normalized_Sample Probe Profile.txt",
sep = "")
CR_PATH <- paste(getwd(),
"/Raw Lung Data/NOT Norm sample Probe Profile-061209.txt",
sep ="")
OTHER_DATA_PATH <- paste(getwd(),
"/Raw Lung Data/Not Normalized_Sample Probe Profile_120709.txt",
sep = "")
LIST_PATH <- paste(getwd(),
"/Raw Lung Data/TranP_annot.txt",
sep = "")
WD <- "C:/Users/rwill127/Documents/GitHub/EMT_Gene_Sig"
#find files
CTR_PATH <- paste(WD,
"/Raw Lung Data/Ptran_not Normalized_Sample Probe Profile.txt",
sep = "")
CR_PATH <- paste(WD,
"/Raw Lung Data/NOT Norm sample Probe Profile-061209.txt",
sep ="")
OTHER_DATA_PATH <- paste(WD,
"/Raw Lung Data/Not Normalized_Sample Probe Profile_120709.txt",
sep = "")
LIST_PATH <- paste(getwd(),
"/Raw Lung Data/TranP_annot.txt",
sep = "")
file_list <- c(CTR_PATH, CR_PATH, OTHER_DATA_PATH)
file_list <- c(CTR_PATH, CR_PATH, OTHER_DATA_PATH)
x.lumi <- lumiR.batch(file_list, lib.mapping = "lumiMouseIDMapping", sampleInfoFile = LIST_PATH)
lumi.T <- lumiT(x.lumi, method = "log2")
dataMatrix <- exprs(lumi.T)
presentCount <- detectionCall(lumi.T)
selDataMatrix <- dataMatrix[presentCount > 0,]
probeList <- rownames(selDataMatrix)
library("lumi")
library("lumiMouseIDMapping")
library("lumiMouseAll.db")
library("annotate")
library("mogene10stprobeset.db")
library("limma")
library("ggplot2")
#home wd
#WD = "E:/Russell/Documents/GitHub/EMT_Gene_Sig"
#work wd
WD = "C:/Users/rwill127/Documents/GitHub/EMT_Gene_Sig"
setwd(WD)
PATH = paste(getwd(), "/Raw Liver Data", sep = "")
file_list <- list.files(path = PATH)
file_list <- paste(PATH, file_list, sep = "/")
x.lumi <- lumiR.batch(file_list, lib.mapping = "lumiMouseIDMapping")
lumi.T <- lumiT(x.lumi, method = "log2")
dataMatrix <- exprs(lumi.T)
presentCount <- detectionCall(lumi.T)
selDataMatrix <- dataMatrix[presentCount > 0,]
probeList <- rownames(selDataMatrix)
oncogene <- c("M",
"Normal",
"Normal",
"M",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"MT",
"M",
"M")
site <- c("Pri",
"Norm",
"Norm",
"Pri",
"Pri",
"Met",
"Pri",
"Met",
"Pri",
"Met",
"Pri",
"Met",
"Pri",
"Met",
"Met",
"Pri",
"Met",
"Met",
"Pri",
"Pri")
annot <- cbind(seq(from = 1, to = 20, by = 1),
colnames(selDataMatrix),
oncogene,
site,
c(rep("A", 10), rep("B", 10))
)
colnames(annot) <- c("sample", "Id", "oncogene", "site", "batch")
annot <- as.data.frame(annot)
annot$exp <- paste(annot$site, annot$oncogene, sep = "_")
batch.trts <- factor(annot$batch)
exp.trts <- factor(annot$exp)
